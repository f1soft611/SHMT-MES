<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="WorkplaceProcessDAO">

	<resultMap id="workplaceProcessResult" type="egovframework.let.basedata.process.domain.model.WorkplaceProcess">
		<result property="workplaceProcessId" column="WORKPLACE_PROCESS_ID"/>
		<result property="workplaceId" column="WORKPLACE_ID"/>
		<result property="processId" column="PROCESS_ID"/>
		<result property="workplaceName" column="WORKPLACE_NAME"/>
		<result property="processCode" column="PROCESS_CODE"/>
		<result property="processName" column="PROCESS_NAME"/>
		<result property="useYn" column="USE_YN"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDt" column="REG_DT"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDt" column="UPD_DT"/>
	</resultMap>

	<select id="WorkplaceProcessDAO.selectWorkplaceProcessList" parameterType="egovframework.let.basedata.process.domain.model.WorkplaceProcessVO" resultMap="workplaceProcessResult">
		SELECT
			wp.WORKPLACE_PROCESS_ID,
			wp.WORKPLACE_ID,
			wp.PROCESS_ID,
			wp.WORKPLACE_NAME,
			p.PROCESS_CODE,
			p.PROCESS_NAME,
			wp.USE_YN,
			wp.REG_USER_ID,
			CONVERT(VARCHAR(19), wp.REG_DT, 120) AS REG_DT,
			wp.UPD_USER_ID,
			CONVERT(VARCHAR(19), wp.UPD_DT, 120) AS UPD_DT
		FROM TB_WORKPLACE_PROCESS wp
		LEFT JOIN TB_PROCESS p ON wp.PROCESS_ID = p.PROCESS_ID
		WHERE 1=1
		<if test="workplaceId != null and workplaceId != ''">
			AND wp.WORKPLACE_ID = #{workplaceId}
		</if>
		<if test="processId != null and processId != ''">
			AND wp.PROCESS_ID = #{processId}
		</if>
		<if test="useYn != null and useYn != ''">
			AND wp.USE_YN = #{useYn}
		</if>
		ORDER BY wp.REG_DT
	</select>

	<insert id="WorkplaceProcessDAO.insertWorkplaceProcess" parameterType="egovframework.let.basedata.process.domain.model.WorkplaceProcess">
		INSERT INTO TB_WORKPLACE_PROCESS (
			WORKPLACE_PROCESS_ID,
			WORKPLACE_ID,
			PROCESS_ID,
			WORKPLACE_NAME,
			USE_YN,
			REG_USER_ID,
			REG_DT
		) VALUES (
					 #{workplaceProcessId},
					 #{workplaceId},
					 #{processId},
					 #{workplaceName},
					 ISNULL(#{useYn}, 'Y'),
					 #{regUserId},
					 GETDATE()
				 )
	</insert>

	<delete id="WorkplaceProcessDAO.deleteWorkplaceProcess" parameterType="string">
		DELETE FROM TB_WORKPLACE_PROCESS
		WHERE WORKPLACE_PROCESS_ID = #{workplaceProcessId}
	</delete>

</mapper>
