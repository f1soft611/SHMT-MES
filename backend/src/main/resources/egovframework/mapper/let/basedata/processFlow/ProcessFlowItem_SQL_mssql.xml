<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ProcessFlowItemDAO">
    <resultMap id="processFlowItemResult" type="egovframework.let.basedata.processFlow.domain.model.ProcessFlowItem">
        <result property="factoryCode" column="FACTORY_CODE"/>
        <result property="processFlowId" column="WORK_ORDER_ID"/>
        <result property="processFlowCode" column="WORK_ORDER"/>
        <result property="flowItemID" column="FLOW_ITEM_ID"/>
        <result property="flowItemCode" column="PROD_CODE"/>

        <result property="regUserId" column="OPMAN_CODE"/>
        <result property="regDt" column="OPTIME"/>
        <result property="updUserId" column="OPMAN_CODE2"/>
        <result property="updDt" column="OPTIME2"/>
    </resultMap>

    <select id="ProcessFlowItemDAO.selectProcessFlowItemList" parameterType="egovframework.let.basedata.processFlow.domain.model.ProcessFlowItemVO" resultMap="processFlowItemResult">
        SELECT
        FACTORY_CODE,
        WORK_ORDER_ID,
        WORK_ORDER,
        FLOW_ITEM_ID,
        PROD_CODE,
        OPTIME,
        OPMAN_CODE,
        OPTIME2,
        OPMAN_CODE2
        FROM TPR112
        WHERE 1=1
        AND FACTORY_CODE = #{factoryCode}
        AND WORK_ORDER_ID = #{processFlowId}
        ORDER BY FLOW_ITEM_ID
    </select>

    <insert id="ProcessFlowItemDAO.insertProcessFlowItem" parameterType="egovframework.let.basedata.processFlow.domain.model.ProcessFlowItem">
        INSERT INTO TPR112 (
            FACTORY_CODE,
            WORK_ORDER_ID,
            WORK_ORDER,
            FLOW_ITEM_ID,
            PROD_CODE,
            OPTIME,
            OPMAN_CODE,
        ) VALUES (
            #{factoryCode},
            #{processFlowId},
            #{processFlowCode},
            #{flowItemID},
            #{flowItemCode},
            GETDATE(),
            'test'
        )
    </insert>

    <update id="ProcessFlowItemDAO.updateProcessFlowItem" parameterType="egovframework.let.basedata.processFlow.domain.model.ProcessFlowItem">
        UPDATE TPR112
        SET
            OPMAN_CODE2 = 'test2',
            OPTIME2 = GETDATE()
        WHERE WORK_ORDER_ID = #{processFlowId}
        AND FLOW_ITEM_ID = #{flowItemID}
    </update>

    <update id="ProcessFlowItemDAO.deleteProcessFlowItem" parameterType="string">
        UPDATE TPR112
        SET DELETE_FLAG = '1'
        WHERE FLOW_ITEM_ID = #{flowItemID}
    </update>


</mapper>